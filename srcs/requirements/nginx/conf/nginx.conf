events {
}

http {
	server {
		listen 443 default ssl;
		ssl_certificate '/etc/ssl/certs/ebillon.42.fr.crt';
		ssl_certificate_key '/etc/ssl/keys/ebillon.42.fr.key';
		ssl_protocols TLSv1.2 TLSv1.3;

		autoindex on;
		root /var/www/wordpress;
		index index.php;

        location = /favicon.ico {
                log_not_found off;
                access_log off;
        }

        location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
        }

		location / {
            # This is cool because no php is touched for static content.
        	# include the "?$args" part so non-default permalinks doesn't break when using query string
            try_files $uri $uri/ /index.php?$args;
        }

		# php form other container
		location ~ \.php$ {
				include snippets/fastcgi-php.conf;
				fastcgi_pass wordpress:9000;
		}

		location ~* \.(js|css|png|jpg|jpeg|gif|ico)$ {
            expires max;
            log_not_found off;
        }
	}
}